<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Sample size calculations for linear mixed models of rate of change based on lmer, lme, or gee "placebo" pilot estimates. — lmmpower • longpower</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Sample size calculations for linear mixed models of rate of change based on lmer, lme, or gee " placebo pilot estimates. lmmpower><meta property="og:description" content='These functions compute sample size for linear mixed models based on the
formula due to Diggle (2002) or Liu and Liang (1997).  These formulae are
expressed in terms of marginal model or Generalized Estimating Equations
(GEE) parameters.  These functions translate pilot mixed effect model
parameters (e.g. random intercept and/or slope, fixed effects, etc.)  into
marginal model parameters so that either formula can be applied to
equivalent affect. Pilot estimates are assumed to be from an appropriate
"placebo" group and the parameter of interest is assumed to be the rate of
change over time of the outcome.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">longpower</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.27</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/longpower.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mcdonohue/longpower/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Sample size calculations for linear mixed models of rate of change based on lmer, lme, or gee "placebo" pilot estimates.</h1>
    <small class="dont-index">Source: <a href="https://github.com/mcdonohue/longpower/blob/master/R/lmmpower.R" class="external-link"><code>R/lmmpower.R</code></a></small>
    <div class="hidden name"><code>lmmpower.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These functions compute sample size for linear mixed models based on the
formula due to Diggle (2002) or Liu and Liang (1997).  These formulae are
expressed in terms of marginal model or Generalized Estimating Equations
(GEE) parameters.  These functions translate pilot mixed effect model
parameters (e.g. random intercept and/or slope, fixed effects, etc.)  into
marginal model parameters so that either formula can be applied to
equivalent affect. Pilot estimates are assumed to be from an appropriate
"placebo" group and the parameter of interest is assumed to be the rate of
change over time of the outcome.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># Default S3 method</span></span>
<span><span class="fu">lmmpower</span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parameter <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  pct.change <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  delta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  t <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sig.level <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  power <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alternative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"two.sided"</span>, <span class="st">"one.sided"</span><span class="op">)</span>,</span>
<span>  beta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  beta.CI <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  delta.CI <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sig2.i <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sig2.s <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sig2.e <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cov.s.i <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cor.s.i <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  R <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"diggle"</span>, <span class="st">"liuliang"</span>, <span class="st">"edland"</span>, <span class="st">"hu"</span><span class="op">)</span>,</span>
<span>  tol <span class="op">=</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">^</span><span class="fl">2</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>an object returned by lme4</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>sample size per group
of a mixed-effects model object to placebo data assumed to have either a
random intercept, or a random intercept and random effect for time (slope);
and fixed effect representing the rate of change in a placebo group.</p></dd>


<dt id="arg-parameter">parameter<a class="anchor" aria-label="anchor" href="#arg-parameter"></a></dt>
<dd><p>the name or position
of the rate of change parameter of interest, e.g. (<code>"time"</code>,
<code>"t"</code>, or <code>2</code> if it is the second specified fixed effect).</p></dd>


<dt id="arg-pct-change">pct.change<a class="anchor" aria-label="anchor" href="#arg-pct-change"></a></dt>
<dd><p>the percent change
in the pilot estimate of the parameter of interest (<code>beta</code>, the
placebo/null effect)</p></dd>


<dt id="arg-delta">delta<a class="anchor" aria-label="anchor" href="#arg-delta"></a></dt>
<dd><p>the change in the pilot estimate
of the parameter of interest, computed from <code>pct.change</code> if left
missing.</p></dd>


<dt id="arg-t">t<a class="anchor" aria-label="anchor" href="#arg-t"></a></dt>
<dd><p>vector of time points</p></dd>


<dt id="arg-sig-level">sig.level<a class="anchor" aria-label="anchor" href="#arg-sig-level"></a></dt>
<dd><p>Type I error</p></dd>


<dt id="arg-power">power<a class="anchor" aria-label="anchor" href="#arg-power"></a></dt>
<dd><p>power</p></dd>


<dt id="arg-alternative">alternative<a class="anchor" aria-label="anchor" href="#arg-alternative"></a></dt>
<dd><p><code>"two.sided"</code> or <code>"one.sided"</code></p></dd>


<dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>pilot estimate of the placebo
effect (slope or rate of change in the outcome)</p></dd>


<dt id="arg-beta-ci">beta.CI<a class="anchor" aria-label="anchor" href="#arg-beta-ci"></a></dt>
<dd><p>95% confidence limits of
the pilot estimate of beta</p></dd>


<dt id="arg-delta-ci">delta.CI<a class="anchor" aria-label="anchor" href="#arg-delta-ci"></a></dt>
<dd><p>95% confidence limits of
the effect size</p></dd>


<dt id="arg-sig-i">sig2.i<a class="anchor" aria-label="anchor" href="#arg-sig-i"></a></dt>
<dd><p>pilot estimate of variance
of random intercept</p></dd>


<dt id="arg-sig-s">sig2.s<a class="anchor" aria-label="anchor" href="#arg-sig-s"></a></dt>
<dd><p>pilot estimate of variance
of random slope</p></dd>


<dt id="arg-sig-e">sig2.e<a class="anchor" aria-label="anchor" href="#arg-sig-e"></a></dt>
<dd><p>pilot estimate of residual
variance</p></dd>


<dt id="arg-cov-s-i">cov.s.i<a class="anchor" aria-label="anchor" href="#arg-cov-s-i"></a></dt>
<dd><p>pilot estimate of
covariance of random slope and intercept</p></dd>


<dt id="arg-cor-s-i">cor.s.i<a class="anchor" aria-label="anchor" href="#arg-cor-s-i"></a></dt>
<dd><p>pilot estimate of
correlation of random slope and intercept</p></dd>


<dt id="arg-r">R<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>pilot estimate of a marginal
model working correlation matrix</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>proportion vector for both groups; if i indexes visits, p[i] = the
proportion whose last visit was at visit i (p sums to 1)</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>the formula to use. Defaults
to <code>"diggle"</code> for Diggle et al (2002). Alternatively <code>"liuliang"</code>
can be selected for Liu &amp; Liang (1997), <code>"edland"</code> for Ard &amp; Edland (2011),
or <code>"hu"</code> for Hu, Mackey &amp; Thomas (2021).</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>numerical tolerance used in root finding.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>other arguments</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An object of class <code>power.htest</code> giving the calculated sample
size, N, per group and other parameters.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Any parameters not explicitly stated are extracted from the fitted
<code>object</code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Diggle P.J., Heagerty P.J., Liang K., Zeger S.L. (2002)
<em>Analysis of longitudinal data</em>. Second Edition. Oxford Statistical
Science Series.</p>
<p>Liu, G., and Liang, K. Y. (1997) Sample size calculations for studies with
correlated observations. <em>Biometrics</em>, 53(3), 937-47.</p>
<p>Ard, C. and Edland, S.D. (2011) Power calculations for clinical trials in Alzheimer's disease.
<em>Journal of Alzheimer's Disease.</em> 21:369-377.</p>
<p>Hu, N., Mackey, H., &amp; Thomas, R. (2021). Power and sample size
for random coefficient regression models in randomized experiments with
monotone missing data. <em>Biometrical Journal</em>, 63(4), 806-824.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="liu.liang.linear.power.html">liu.liang.linear.power</a></code>,
<code><a href="diggle.linear.power.html">diggle.linear.power</a></code>, <code><a href="edland.linear.power.html">edland.linear.power</a></code>,
<code><a href="hu.mackey.thomas.linear.power.html">hu.mackey.thomas.linear.power</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Michael C. Donohue</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/browseVignettes.html" class="external-link">browseVignettes</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"longpower"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">lmmpower</span><span class="op">(</span>delta<span class="op">=</span><span class="fl">1.5</span>, t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1.5</span>,<span class="fl">0.25</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sig2.i <span class="op">=</span> <span class="fl">55</span>, sig2.s <span class="op">=</span> <span class="fl">24</span>, sig2.e <span class="op">=</span> <span class="fl">10</span>, cov.s.i<span class="op">=</span><span class="fl">0.8</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">55</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">24</span><span class="op">)</span>, power <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Longitudinal linear model slope power calculation (Diggle et al 2002, page 29) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               N = 414.6202</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               n = 207.3101, 207.3101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           delta = 1.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          sigma2 = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       sig.level = 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           power = 0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     alternative = two.sided</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  NOTE: N is *total* sample size and n is sample size in *each* group </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  R:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]      [,2]      [,3]      [,4]      [,5]     [,6]      [,7]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 65.00000  62.26636  69.53272  76.79908  84.06544  91.3318  98.59817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 62.26636  81.03272  79.79908  88.56544  97.33180 106.0982 114.86453</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 69.53272  79.79908 100.06544 100.33180 110.59817 120.8645 131.13089</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 76.79908  88.56544 100.33180 122.09817 123.86453 135.6309 147.39725</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 84.06544  97.33180 110.59817 123.86453 147.13089 150.3972 163.66361</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] 91.33180 106.09817 120.86453 135.63089 150.39725 175.1636 179.92997</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7,] 98.59817 114.86453 131.13089 147.39725 163.66361 179.9300 206.19633</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">lmmpower</span><span class="op">(</span>n<span class="op">=</span><span class="fl">208</span>, t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1.5</span>,<span class="fl">0.25</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sig2.i <span class="op">=</span> <span class="fl">55</span>, sig2.s <span class="op">=</span> <span class="fl">24</span>, sig2.e <span class="op">=</span> <span class="fl">10</span>, cov.s.i<span class="op">=</span><span class="fl">0.8</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">55</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">24</span><span class="op">)</span>, power <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Longitudinal linear model slope power calculation (Diggle et al 2002, page 29) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               N = 416</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               n = 208, 208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           delta = 1.49751</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          sigma2 = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       sig.level = 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           power = 0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     alternative = two.sided</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  NOTE: N is *total* sample size and n is sample size in *each* group </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  R:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]      [,2]      [,3]      [,4]      [,5]     [,6]      [,7]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 65.00000  62.26636  69.53272  76.79908  84.06544  91.3318  98.59817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 62.26636  81.03272  79.79908  88.56544  97.33180 106.0982 114.86453</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 69.53272  79.79908 100.06544 100.33180 110.59817 120.8645 131.13089</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 76.79908  88.56544 100.33180 122.09817 123.86453 135.6309 147.39725</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 84.06544  97.33180 110.59817 123.86453 147.13089 150.3972 163.66361</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] 91.33180 106.09817 120.86453 135.63089 150.39725 175.1636 179.92997</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7,] 98.59817 114.86453 131.13089 147.39725 163.66361 179.9300 206.19633</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">lmmpower</span><span class="op">(</span>beta <span class="op">=</span> <span class="fl">5</span>, pct.change <span class="op">=</span> <span class="fl">0.30</span>, t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1.5</span>,<span class="fl">0.25</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sig2.i <span class="op">=</span> <span class="fl">55</span>, sig2.s <span class="op">=</span> <span class="fl">24</span>, sig2.e <span class="op">=</span> <span class="fl">10</span>, cov.s.i<span class="op">=</span><span class="fl">0.8</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">55</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">24</span><span class="op">)</span>, power <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Longitudinal linear model slope power calculation (Diggle et al 2002, page 29) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               N = 414.6202</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               n = 207.3101, 207.3101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           delta = 1.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          sigma2 = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       sig.level = 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           power = 0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     alternative = two.sided</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            beta = 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  NOTE: N is *total* sample size and n is sample size in *each* group </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  R:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]      [,2]      [,3]      [,4]      [,5]     [,6]      [,7]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 65.00000  62.26636  69.53272  76.79908  84.06544  91.3318  98.59817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 62.26636  81.03272  79.79908  88.56544  97.33180 106.0982 114.86453</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 69.53272  79.79908 100.06544 100.33180 110.59817 120.8645 131.13089</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 76.79908  88.56544 100.33180 122.09817 123.86453 135.6309 147.39725</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 84.06544  97.33180 110.59817 123.86453 147.13089 150.3972 163.66361</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] 91.33180 106.09817 120.86453 135.63089 150.39725 175.1636 179.92997</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7,] 98.59817 114.86453 131.13089 147.39725 163.66361 179.9300 206.19633</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">Reaction</span> <span class="op">~</span> <span class="va">Days</span> <span class="op">+</span> <span class="op">(</span><span class="va">Days</span><span class="op">|</span><span class="va">Subject</span><span class="op">)</span>, <span class="va">sleepstudy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">lmmpower</span><span class="op">(</span><span class="va">fm1</span>, pct.change <span class="op">=</span> <span class="fl">0.30</span>, t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">9</span>,<span class="fl">1</span><span class="op">)</span>, power <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/" class="external-link">nlme</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme</a></span><span class="op">(</span><span class="va">Reaction</span> <span class="op">~</span> <span class="va">Days</span>, random<span class="op">=</span><span class="op">~</span><span class="va">Days</span><span class="op">|</span><span class="va">Subject</span>, <span class="va">sleepstudy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">lmmpower</span><span class="op">(</span><span class="va">fm2</span>, pct.change <span class="op">=</span> <span class="fl">0.30</span>, t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">9</span>,<span class="fl">1</span><span class="op">)</span>, power <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># random intercept only</span></span></span>
<span class="r-in"><span><span class="va">fm3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme</a></span><span class="op">(</span><span class="va">Reaction</span> <span class="op">~</span> <span class="va">Days</span>, random<span class="op">=</span><span class="op">~</span><span class="fl">1</span><span class="op">|</span><span class="va">Subject</span>, <span class="va">sleepstudy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">lmmpower</span><span class="op">(</span><span class="va">fm3</span>, pct.change <span class="op">=</span> <span class="fl">0.30</span>, t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">9</span>,<span class="fl">1</span><span class="op">)</span>, power <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gee</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fm4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gee/man/gee.html" class="external-link">gee</a></span><span class="op">(</span><span class="va">Reaction</span> <span class="op">~</span> <span class="va">Days</span>, id <span class="op">=</span> <span class="va">Subject</span>,</span></span>
<span class="r-in"><span>            data <span class="op">=</span> <span class="va">sleepstudy</span>,</span></span>
<span class="r-in"><span>            corstr <span class="op">=</span> <span class="st">"exchangeable"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">lmmpower</span><span class="op">(</span><span class="va">fm4</span>, pct.change <span class="op">=</span> <span class="fl">0.30</span>, t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">9</span>,<span class="fl">1</span><span class="op">)</span>, power <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Michael C. Donohue.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

